"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/files";
exports.ids = ["pages/api/files"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "node-telegram-bot-api":
/*!****************************************!*\
  !*** external "node-telegram-bot-api" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("node-telegram-bot-api");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "@upstash/redis":
/*!*********************************!*\
  !*** external "@upstash/redis" ***!
  \*********************************/
/***/ ((module) => {

module.exports = import("@upstash/redis");;

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

module.exports = import("axios");;

/***/ }),

/***/ "formidable":
/*!*****************************!*\
  !*** external "formidable" ***!
  \*****************************/
/***/ ((module) => {

module.exports = import("formidable");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffiles&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cfiles.js&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffiles&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cfiles.js&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_files_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\files.js */ \"(api)/./pages/api/files.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_files_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_files_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_files_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_files_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/files\",\n        pathname: \"/api/files\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_files_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmZpbGVzJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlNUNhcGklNUNmaWxlcy5qcyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUNtRDtBQUNuRDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsZ0RBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLGdEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCxxQyIsInNvdXJjZXMiOlsid2VicGFjazovL3RnLW5ldC1idWNrZXQvPzY5YmYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzXFxcXGFwaVxcXFxmaWxlcy5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2ZpbGVzXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZmlsZXNcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffiles&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cfiles.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/files.js":
/*!****************************!*\
  !*** ./pages/api/files.js ***!
  \****************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _src_telegram_storage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../src/telegram_storage */ \"(api)/./src/telegram_storage.js\");\n/* harmony import */ var formidable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! formidable */ \"formidable\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_2__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_telegram_storage__WEBPACK_IMPORTED_MODULE_0__, formidable__WEBPACK_IMPORTED_MODULE_1__]);\n([_src_telegram_storage__WEBPACK_IMPORTED_MODULE_0__, formidable__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n// 禁用Next.js的默认body解析，以便处理文件上传\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\n/**\n * 验证环境变量是否配置正确\n * @returns {Object} 验证结果\n */ function validateEnvironmentVariables() {\n    const botToken = process.env.TELEGRAM_BOT_TOKEN;\n    const chatId = process.env.TELEGRAM_CHAT_ID;\n    if (!botToken) {\n        return {\n            valid: false,\n            error: \"缺少环境变量 TELEGRAM_BOT_TOKEN\"\n        };\n    }\n    if (!chatId) {\n        return {\n            valid: false,\n            error: \"缺少环境变量 TELEGRAM_CHAT_ID\"\n        };\n    }\n    return {\n        valid: true,\n        botToken,\n        chatId\n    };\n}\nasync function handler(req, res) {\n    const { method } = req;\n    // 验证环境变量\n    const envValidation = validateEnvironmentVariables();\n    if (!envValidation.valid) {\n        return res.status(500).json({\n            success: false,\n            error: `配置错误: ${envValidation.error}`\n        });\n    }\n    // 创建TelegramStorage实例\n    const telegramStorage = new _src_telegram_storage__WEBPACK_IMPORTED_MODULE_0__.TelegramStorage({\n        botToken: envValidation.botToken,\n        chatId: envValidation.chatId\n    });\n    switch(method){\n        case \"GET\":\n            // 获取文件列表\n            try {\n                const files = await telegramStorage.listFiles();\n                res.status(200).json({\n                    success: true,\n                    files\n                });\n            } catch (error) {\n                res.status(500).json({\n                    success: false,\n                    error: error.message\n                });\n            }\n            break;\n        case \"POST\":\n            // 上传文件\n            try {\n                const form = new formidable__WEBPACK_IMPORTED_MODULE_1__.IncomingForm();\n                form.parse(req, async (err, fields, files)=>{\n                    if (err) {\n                        console.error(\"文件解析错误:\", err);\n                        return res.status(500).json({\n                            success: false,\n                            error: `文件解析失败: ${err.message}`\n                        });\n                    }\n                    // 在formidable v3中，files.file是一个数组\n                    const fileArray = files.file;\n                    if (!fileArray || !Array.isArray(fileArray) || fileArray.length === 0) {\n                        console.error(\"没有提供文件\");\n                        return res.status(400).json({\n                            success: false,\n                            error: \"没有提供文件\"\n                        });\n                    }\n                    const file = fileArray[0]; // 获取第一个文件\n                    if (!file || !file.filepath) {\n                        console.error(\"文件对象无效或缺少文件路径\");\n                        return res.status(400).json({\n                            success: false,\n                            error: \"文件对象无效或缺少文件路径\"\n                        });\n                    }\n                    try {\n                        console.log(`开始上传文件: ${file.originalFilename}, 大小: ${file.size} bytes`);\n                        const fileBuffer = fs__WEBPACK_IMPORTED_MODULE_2___default().readFileSync(file.filepath);\n                        const result = await telegramStorage.uploadFile(fileBuffer, file.originalFilename);\n                        console.log(`文件上传成功: ${file.originalFilename}, fileId: ${result.fileId}`);\n                        res.status(200).json({\n                            success: true,\n                            fileId: result.fileId,\n                            messageId: result.messageId\n                        });\n                    } catch (uploadError) {\n                        console.error(\"文件上传到Telegram失败:\", uploadError);\n                        return res.status(500).json({\n                            success: false,\n                            error: `上传失败: ${uploadError.message}`\n                        });\n                    }\n                });\n            } catch (error) {\n                console.error(\"POST请求处理错误:\", error);\n                res.status(500).json({\n                    success: false,\n                    error: `请求处理失败: ${error.message}`\n                });\n            }\n            break;\n        case \"DELETE\":\n            // 删除文件\n            try {\n                const { messageId } = req.query;\n                if (!messageId) {\n                    return res.status(400).json({\n                        success: false,\n                        error: \"没有提供消息ID\"\n                    });\n                }\n                const result = await telegramStorage.deleteFile(messageId);\n                res.status(200).json({\n                    success: true,\n                    result\n                });\n            } catch (error) {\n                res.status(500).json({\n                    success: false,\n                    error: error.message\n                });\n            }\n            break;\n        default:\n            res.setHeader(\"Allow\", [\n                \"GET\",\n                \"POST\",\n                \"DELETE\"\n            ]);\n            res.status(405).end(`Method ${method} Not Allowed`);\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNNkIsU0FBUyxNQUFNcEIsZ0JBQWdCMEIsVUFBVSxDQUFDSDtnQkFDaEQ3QixJQUFJRyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO29CQUFFQyxTQUFTO29CQUFNcUI7Z0JBQU87WUFDL0MsRUFBRSxPQUFPN0IsT0FBTztnQkFDZEcsSUFBSUcsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztvQkFBRUMsU0FBUztvQkFBT1IsT0FBT0EsTUFBTVksT0FBTztnQkFBQztZQUM5RDtZQUNBO1FBRUY7WUFDRVQsSUFBSWlDLFNBQVMsQ0FBQyxTQUFTO2dCQUFDO2dCQUFPO2dCQUFRO2FBQVM7WUFDaERqQyxJQUFJRyxNQUFNLENBQUMsS0FBSytCLEdBQUcsQ0FBQyxDQUFDLE9BQU8sRUFBRWpDLE9BQU8sWUFBWSxDQUFDO0lBQ3REO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90Zy1uZXQtYnVja2V0Ly4vcGFnZXMvYXBpL2ZpbGVzLmpzPzJhZGQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVGVsZWdyYW1TdG9yYWdlIH0gZnJvbSAnLi4vLi4vc3JjL3RlbGVncmFtX3N0b3JhZ2UnO1xuaW1wb3J0IHsgSW5jb21pbmdGb3JtIH0gZnJvbSAnZm9ybWlkYWJsZSc7XG5pbXBvcnQgZnMgZnJvbSAnZnMnO1xuXG4vLyDnpoHnlKhOZXh0Lmpz55qE6buY6K6kYm9keeino+aekO+8jOS7peS+v+WkhOeQhuaWh+S7tuS4iuS8oFxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgYXBpOiB7XG4gICAgYm9keVBhcnNlcjogZmFsc2UsXG4gIH0sXG59O1xuXG4vKipcbiAqIOmqjOivgeeOr+Wig+WPmOmHj+aYr+WQpumFjee9ruato+ehrlxuICogQHJldHVybnMge09iamVjdH0g6aqM6K+B57uT5p6cXG4gKi9cbmZ1bmN0aW9uIHZhbGlkYXRlRW52aXJvbm1lbnRWYXJpYWJsZXMoKSB7XG4gIGNvbnN0IGJvdFRva2VuID0gcHJvY2Vzcy5lbnYuVEVMRUdSQU1fQk9UX1RPS0VOO1xuICBjb25zdCBjaGF0SWQgPSBwcm9jZXNzLmVudi5URUxFR1JBTV9DSEFUX0lEO1xuICBcbiAgaWYgKCFib3RUb2tlbikge1xuICAgIHJldHVybiB7IHZhbGlkOiBmYWxzZSwgZXJyb3I6ICfnvLrlsJHnjq/looPlj5jph48gVEVMRUdSQU1fQk9UX1RPS0VOJyB9O1xuICB9XG4gIFxuICBpZiAoIWNoYXRJZCkge1xuICAgIHJldHVybiB7IHZhbGlkOiBmYWxzZSwgZXJyb3I6ICfnvLrlsJHnjq/looPlj5jph48gVEVMRUdSQU1fQ0hBVF9JRCcgfTtcbiAgfVxuICBcbiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGJvdFRva2VuLCBjaGF0SWQgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xuICBjb25zdCB7IG1ldGhvZCB9ID0gcmVxO1xuICBcbiAgLy8g6aqM6K+B546v5aKD5Y+Y6YePXG4gIGNvbnN0IGVudlZhbGlkYXRpb24gPSB2YWxpZGF0ZUVudmlyb25tZW50VmFyaWFibGVzKCk7XG4gIGlmICghZW52VmFsaWRhdGlvbi52YWxpZCkge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IFxuICAgICAgc3VjY2VzczogZmFsc2UsIFxuICAgICAgZXJyb3I6IGDphY3nva7plJnor686ICR7ZW52VmFsaWRhdGlvbi5lcnJvcn1gIFxuICAgIH0pO1xuICB9XG4gIFxuICAvLyDliJvlu7pUZWxlZ3JhbVN0b3JhZ2Xlrp7kvotcbiAgY29uc3QgdGVsZWdyYW1TdG9yYWdlID0gbmV3IFRlbGVncmFtU3RvcmFnZSh7XG4gICAgYm90VG9rZW46IGVudlZhbGlkYXRpb24uYm90VG9rZW4sXG4gICAgY2hhdElkOiBlbnZWYWxpZGF0aW9uLmNoYXRJZFxuICB9KTtcblxuICBzd2l0Y2ggKG1ldGhvZCkge1xuICAgIGNhc2UgJ0dFVCc6XG4gICAgICAvLyDojrflj5bmlofku7bliJfooahcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGZpbGVzID0gYXdhaXQgdGVsZWdyYW1TdG9yYWdlLmxpc3RGaWxlcygpO1xuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHN1Y2Nlc3M6IHRydWUsIGZpbGVzIH0pO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XG4gICAgICB9XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ1BPU1QnOlxuICAgICAgLy8g5LiK5Lyg5paH5Lu2XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBmb3JtID0gbmV3IEluY29taW5nRm9ybSgpO1xuICAgICAgICBmb3JtLnBhcnNlKHJlcSwgYXN5bmMgKGVyciwgZmllbGRzLCBmaWxlcykgPT4ge1xuICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+aWh+S7tuino+aekOmUmeivrzonLCBlcnIpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgICAgICAgICAgZXJyb3I6IGDmlofku7bop6PmnpDlpLHotKU6ICR7ZXJyLm1lc3NhZ2V9YCBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIOWcqGZvcm1pZGFibGUgdjPkuK3vvIxmaWxlcy5maWxl5piv5LiA5Liq5pWw57uEXG4gICAgICAgICAgY29uc3QgZmlsZUFycmF5ID0gZmlsZXMuZmlsZTtcbiAgICAgICAgICBpZiAoIWZpbGVBcnJheSB8fCAhQXJyYXkuaXNBcnJheShmaWxlQXJyYXkpIHx8IGZpbGVBcnJheS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+ayoeacieaPkOS+m+aWh+S7ticpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgXG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgICAgICAgICAgZXJyb3I6ICfmsqHmnInmj5Dkvpvmlofku7YnIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgZmlsZSA9IGZpbGVBcnJheVswXTsgLy8g6I635Y+W56ys5LiA5Liq5paH5Lu2XG4gICAgICAgICAgaWYgKCFmaWxlIHx8ICFmaWxlLmZpbGVwYXRoKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCfmlofku7blr7nosaHml6DmlYjmiJbnvLrlsJHmlofku7bot6/lvoQnKTtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IFxuICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSwgXG4gICAgICAgICAgICAgIGVycm9yOiAn5paH5Lu25a+56LGh5peg5pWI5oiW57y65bCR5paH5Lu26Lev5b6EJyBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg5byA5aeL5LiK5Lyg5paH5Lu2OiAke2ZpbGUub3JpZ2luYWxGaWxlbmFtZX0sIOWkp+WwjzogJHtmaWxlLnNpemV9IGJ5dGVzYCk7XG4gICAgICAgICAgICBjb25zdCBmaWxlQnVmZmVyID0gZnMucmVhZEZpbGVTeW5jKGZpbGUuZmlsZXBhdGgpO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGVsZWdyYW1TdG9yYWdlLnVwbG9hZEZpbGUoZmlsZUJ1ZmZlciwgZmlsZS5vcmlnaW5hbEZpbGVuYW1lKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc29sZS5sb2coYOaWh+S7tuS4iuS8oOaIkOWKnzogJHtmaWxlLm9yaWdpbmFsRmlsZW5hbWV9LCBmaWxlSWQ6ICR7cmVzdWx0LmZpbGVJZH1gKTtcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgXG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsIFxuICAgICAgICAgICAgICBmaWxlSWQ6IHJlc3VsdC5maWxlSWQsIFxuICAgICAgICAgICAgICBtZXNzYWdlSWQ6IHJlc3VsdC5tZXNzYWdlSWQgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGNhdGNoICh1cGxvYWRFcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign5paH5Lu25LiK5Lyg5YiwVGVsZWdyYW3lpLHotKU6JywgdXBsb2FkRXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgICAgICAgICAgZXJyb3I6IGDkuIrkvKDlpLHotKU6ICR7dXBsb2FkRXJyb3IubWVzc2FnZX1gIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1BPU1Tor7fmsYLlpITnkIbplJnor686JywgZXJyb3IpO1xuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IFxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgICAgICBlcnJvcjogYOivt+axguWkhOeQhuWksei0pTogJHtlcnJvci5tZXNzYWdlfWAgXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdERUxFVEUnOlxuICAgICAgLy8g5Yig6Zmk5paH5Lu2XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB7IG1lc3NhZ2VJZCB9ID0gcmVxLnF1ZXJ5O1xuICAgICAgICBpZiAoIW1lc3NhZ2VJZCkge1xuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ+ayoeacieaPkOS+m+a2iOaBr0lEJyB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRlbGVncmFtU3RvcmFnZS5kZWxldGVGaWxlKG1lc3NhZ2VJZCk7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgcmVzdWx0IH0pO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XG4gICAgICB9XG4gICAgICBicmVhaztcblxuICAgIGRlZmF1bHQ6XG4gICAgICByZXMuc2V0SGVhZGVyKCdBbGxvdycsIFsnR0VUJywgJ1BPU1QnLCAnREVMRVRFJ10pO1xuICAgICAgcmVzLnN0YXR1cyg0MDUpLmVuZChgTWV0aG9kICR7bWV0aG9kfSBOb3QgQWxsb3dlZGApO1xuICB9XG59Il0sIm5hbWVzIjpbIlRlbGVncmFtU3RvcmFnZSIsIkluY29taW5nRm9ybSIsImZzIiwiY29uZmlnIiwiYXBpIiwiYm9keVBhcnNlciIsInZhbGlkYXRlRW52aXJvbm1lbnRWYXJpYWJsZXMiLCJib3RUb2tlbiIsInByb2Nlc3MiLCJlbnYiLCJURUxFR1JBTV9CT1RfVE9LRU4iLCJjaGF0SWQiLCJURUxFR1JBTV9DSEFUX0lEIiwidmFsaWQiLCJlcnJvciIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJlbnZWYWxpZGF0aW9uIiwic3RhdHVzIiwianNvbiIsInN1Y2Nlc3MiLCJ0ZWxlZ3JhbVN0b3JhZ2UiLCJmaWxlcyIsImxpc3RGaWxlcyIsIm1lc3NhZ2UiLCJmb3JtIiwicGFyc2UiLCJlcnIiLCJmaWVsZHMiLCJjb25zb2xlIiwiZmlsZUFycmF5IiwiZmlsZSIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsImZpbGVwYXRoIiwibG9nIiwib3JpZ2luYWxGaWxlbmFtZSIsInNpemUiLCJmaWxlQnVmZmVyIiwicmVhZEZpbGVTeW5jIiwicmVzdWx0IiwidXBsb2FkRmlsZSIsImZpbGVJZCIsIm1lc3NhZ2VJZCIsInVwbG9hZEVycm9yIiwicXVlcnkiLCJkZWxldGVGaWxlIiwic2V0SGVhZGVyIiwiZW5kIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/files.js\n");

/***/ }),

/***/ "(api)/./src/redis_client.js":
/*!*****************************!*\
  !*** ./src/redis_client.js ***!
  \*****************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RedisClient: () => (/* binding */ RedisClient),\n/* harmony export */   redisClient: () => (/* binding */ redisClient)\n/* harmony export */ });\n/* harmony import */ var _upstash_redis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @upstash/redis */ \"@upstash/redis\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_upstash_redis__WEBPACK_IMPORTED_MODULE_0__]);\n_upstash_redis__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n/**\r\n * Redis客户端配置和连接管理\r\n * 使用Upstash Redis作为持久化存储\r\n */ class RedisClient {\n    constructor(){\n        // 从环境变量获取Upstash Redis配置\n        this.redisUrl = process.env.UPSTASH_REDIS_REST_URL;\n        this.redisToken = process.env.UPSTASH_REDIS_REST_TOKEN;\n        if (!this.redisUrl || !this.redisToken) {\n            console.warn(\"Upstash Redis配置未找到，将使用内存存储（仅用于开发环境）\");\n            this.redis = null;\n            this.memoryStore = new Map(); // 开发环境的内存存储\n        } else {\n            // 初始化Upstash Redis客户端\n            this.redis = new _upstash_redis__WEBPACK_IMPORTED_MODULE_0__.Redis({\n                url: this.redisUrl,\n                token: this.redisToken\n            });\n        }\n    }\n    /**\r\n   * 获取Redis客户端实例\r\n   * @returns {Redis|null} Redis客户端实例或null（如果未配置）\r\n   */ getClient() {\n        return this.redis;\n    }\n    /**\r\n   * 检查Redis连接是否可用\r\n   * @returns {boolean} 连接状态\r\n   */ isConnected() {\n        return this.redis !== null;\n    }\n    /**\r\n   * 设置键值对\r\n   * @param {string} key - 键\r\n   * @param {any} value - 值\r\n   * @param {number} [ttl] - 过期时间（秒）\r\n   * @returns {Promise<boolean>} 操作结果\r\n   */ async set(key, value, ttl = null) {\n        try {\n            if (this.redis) {\n                const serializedValue = JSON.stringify(value);\n                if (ttl) {\n                    await this.redis.setex(key, ttl, serializedValue);\n                } else {\n                    await this.redis.set(key, serializedValue);\n                }\n                return true;\n            } else {\n                // 使用内存存储作为后备\n                this.memoryStore.set(key, {\n                    value,\n                    timestamp: Date.now(),\n                    ttl\n                });\n                return true;\n            }\n        } catch (error) {\n            console.error(\"Redis设置失败:\", error);\n            return false;\n        }\n    }\n    /**\r\n   * 获取值\r\n   * @param {string} key - 键\r\n   * @returns {Promise<any|null>} 值或null\r\n   */ async get(key) {\n        try {\n            if (this.redis) {\n                const value = await this.redis.get(key);\n                return value ? JSON.parse(value) : null;\n            } else {\n                // 使用内存存储作为后备\n                const item = this.memoryStore.get(key);\n                if (!item) return null;\n                // 检查是否过期\n                if (item.ttl && Date.now() - item.timestamp > item.ttl * 1000) {\n                    this.memoryStore.delete(key);\n                    return null;\n                }\n                return item.value;\n            }\n        } catch (error) {\n            console.error(\"Redis获取失败:\", error);\n            return null;\n        }\n    }\n    /**\r\n   * 删除键\r\n   * @param {string} key - 键\r\n   * @returns {Promise<boolean>} 操作结果\r\n   */ async del(key) {\n        try {\n            if (this.redis) {\n                await this.redis.del(key);\n                return true;\n            } else {\n                // 使用内存存储作为后备\n                return this.memoryStore.delete(key);\n            }\n        } catch (error) {\n            console.error(\"Redis删除失败:\", error);\n            return false;\n        }\n    }\n    /**\r\n   * 向列表添加元素\r\n   * @param {string} key - 列表键\r\n   * @param {any} value - 要添加的值\r\n   * @returns {Promise<boolean>} 操作结果\r\n   */ async lpush(key, value) {\n        try {\n            if (this.redis) {\n                await this.redis.lpush(key, JSON.stringify(value));\n                return true;\n            } else {\n                // 使用内存存储作为后备\n                const list = this.memoryStore.get(key)?.value || [];\n                list.unshift(value);\n                this.memoryStore.set(key, {\n                    value: list,\n                    timestamp: Date.now()\n                });\n                return true;\n            }\n        } catch (error) {\n            console.error(\"Redis列表添加失败:\", error);\n            return false;\n        }\n    }\n    /**\r\n   * 获取列表所有元素\r\n   * @param {string} key - 列表键\r\n   * @returns {Promise<Array>} 列表元素\r\n   */ async lrange(key, start = 0, end = -1) {\n        try {\n            if (this.redis) {\n                const items = await this.redis.lrange(key, start, end);\n                return items.map((item)=>JSON.parse(item));\n            } else {\n                // 使用内存存储作为后备\n                const list = this.memoryStore.get(key)?.value || [];\n                if (end === -1) end = list.length - 1;\n                return list.slice(start, end + 1);\n            }\n        } catch (error) {\n            console.error(\"Redis列表获取失败:\", error);\n            return [];\n        }\n    }\n    /**\r\n   * 从列表中移除元素\r\n   * @param {string} key - 列表键\r\n   * @param {any} value - 要移除的值\r\n   * @returns {Promise<boolean>} 操作结果\r\n   */ async lrem(key, value) {\n        try {\n            if (this.redis) {\n                await this.redis.lrem(key, 0, JSON.stringify(value));\n                return true;\n            } else {\n                // 使用内存存储作为后备\n                const list = this.memoryStore.get(key)?.value || [];\n                const index = list.findIndex((item)=>JSON.stringify(item) === JSON.stringify(value));\n                if (index !== -1) {\n                    list.splice(index, 1);\n                    this.memoryStore.set(key, {\n                        value: list,\n                        timestamp: Date.now()\n                    });\n                }\n                return true;\n            }\n        } catch (error) {\n            console.error(\"Redis列表移除失败:\", error);\n            return false;\n        }\n    }\n}\n// 创建单例实例\nconst redisClient = new RedisClient();\n\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90Zy1uZXQtYnVja2V0Ly4vc3JjL3JlZGlzX2NsaWVudC5qcz84YmY0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJlZGlzIH0gZnJvbSAnQHVwc3Rhc2gvcmVkaXMnO1xyXG5cclxuLyoqXHJcbiAqIFJlZGlz5a6i5oi356uv6YWN572u5ZKM6L+e5o6l566h55CGXHJcbiAqIOS9v+eUqFVwc3Rhc2ggUmVkaXPkvZzkuLrmjIHkuYXljJblrZjlgqhcclxuICovXHJcbmNsYXNzIFJlZGlzQ2xpZW50IHtcclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIC8vIOS7jueOr+Wig+WPmOmHj+iOt+WPllVwc3Rhc2ggUmVkaXPphY3nva5cclxuICAgIHRoaXMucmVkaXNVcmwgPSBwcm9jZXNzLmVudi5VUFNUQVNIX1JFRElTX1JFU1RfVVJMO1xyXG4gICAgdGhpcy5yZWRpc1Rva2VuID0gcHJvY2Vzcy5lbnYuVVBTVEFTSF9SRURJU19SRVNUX1RPS0VOO1xyXG4gICAgXHJcbiAgICBpZiAoIXRoaXMucmVkaXNVcmwgfHwgIXRoaXMucmVkaXNUb2tlbikge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ1Vwc3Rhc2ggUmVkaXPphY3nva7mnKrmib7liLDvvIzlsIbkvb/nlKjlhoXlrZjlrZjlgqjvvIjku4XnlKjkuo7lvIDlj5Hnjq/looPvvIknKTtcclxuICAgICAgdGhpcy5yZWRpcyA9IG51bGw7XHJcbiAgICAgIHRoaXMubWVtb3J5U3RvcmUgPSBuZXcgTWFwKCk7IC8vIOW8gOWPkeeOr+Wig+eahOWGheWtmOWtmOWCqFxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8g5Yid5aeL5YyWVXBzdGFzaCBSZWRpc+WuouaIt+err1xyXG4gICAgICB0aGlzLnJlZGlzID0gbmV3IFJlZGlzKHtcclxuICAgICAgICB1cmw6IHRoaXMucmVkaXNVcmwsXHJcbiAgICAgICAgdG9rZW46IHRoaXMucmVkaXNUb2tlbixcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5ZSZWRpc+WuouaIt+err+WunuS+i1xyXG4gICAqIEByZXR1cm5zIHtSZWRpc3xudWxsfSBSZWRpc+WuouaIt+err+WunuS+i+aIlm51bGzvvIjlpoLmnpzmnKrphY3nva7vvIlcclxuICAgKi9cclxuICBnZXRDbGllbnQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5yZWRpcztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOajgOafpVJlZGlz6L+e5o6l5piv5ZCm5Y+v55SoXHJcbiAgICogQHJldHVybnMge2Jvb2xlYW59IOi/nuaOpeeKtuaAgVxyXG4gICAqL1xyXG4gIGlzQ29ubmVjdGVkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMucmVkaXMgIT09IG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDorr7nva7plK7lgLzlr7lcclxuICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IC0g6ZSuXHJcbiAgICogQHBhcmFtIHthbnl9IHZhbHVlIC0g5YC8XHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IFt0dGxdIC0g6L+H5pyf5pe26Ze077yI56eS77yJXHJcbiAgICogQHJldHVybnMge1Byb21pc2U8Ym9vbGVhbj59IOaTjeS9nOe7k+aenFxyXG4gICAqL1xyXG4gIGFzeW5jIHNldChrZXksIHZhbHVlLCB0dGwgPSBudWxsKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAodGhpcy5yZWRpcykge1xyXG4gICAgICAgIGNvbnN0IHNlcmlhbGl6ZWRWYWx1ZSA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcclxuICAgICAgICBpZiAodHRsKSB7XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlZGlzLnNldGV4KGtleSwgdHRsLCBzZXJpYWxpemVkVmFsdWUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlZGlzLnNldChrZXksIHNlcmlhbGl6ZWRWYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIOS9v+eUqOWGheWtmOWtmOWCqOS9nOS4uuWQjuWkh1xyXG4gICAgICAgIHRoaXMubWVtb3J5U3RvcmUuc2V0KGtleSwgeyB2YWx1ZSwgdGltZXN0YW1wOiBEYXRlLm5vdygpLCB0dGwgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1JlZGlz6K6+572u5aSx6LSlOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W5YC8XHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IGtleSAtIOmUrlxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPGFueXxudWxsPn0g5YC85oiWbnVsbFxyXG4gICAqL1xyXG4gIGFzeW5jIGdldChrZXkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmICh0aGlzLnJlZGlzKSB7XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSBhd2FpdCB0aGlzLnJlZGlzLmdldChrZXkpO1xyXG4gICAgICAgIHJldHVybiB2YWx1ZSA/IEpTT04ucGFyc2UodmFsdWUpIDogbnVsbDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyDkvb/nlKjlhoXlrZjlrZjlgqjkvZzkuLrlkI7lpIdcclxuICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5tZW1vcnlTdG9yZS5nZXQoa2V5KTtcclxuICAgICAgICBpZiAoIWl0ZW0pIHJldHVybiBudWxsO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOajgOafpeaYr+WQpui/h+acn1xyXG4gICAgICAgIGlmIChpdGVtLnR0bCAmJiAoRGF0ZS5ub3coKSAtIGl0ZW0udGltZXN0YW1wKSA+IGl0ZW0udHRsICogMTAwMCkge1xyXG4gICAgICAgICAgdGhpcy5tZW1vcnlTdG9yZS5kZWxldGUoa2V5KTtcclxuICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gaXRlbS52YWx1ZTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignUmVkaXPojrflj5blpLHotKU6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWIoOmZpOmUrlxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSDplK5cclxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxib29sZWFuPn0g5pON5L2c57uT5p6cXHJcbiAgICovXHJcbiAgYXN5bmMgZGVsKGtleSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgaWYgKHRoaXMucmVkaXMpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLnJlZGlzLmRlbChrZXkpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIOS9v+eUqOWGheWtmOWtmOWCqOS9nOS4uuWQjuWkh1xyXG4gICAgICAgIHJldHVybiB0aGlzLm1lbW9yeVN0b3JlLmRlbGV0ZShrZXkpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdSZWRpc+WIoOmZpOWksei0pTonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWQkeWIl+ihqOa3u+WKoOWFg+e0oFxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSDliJfooajplK5cclxuICAgKiBAcGFyYW0ge2FueX0gdmFsdWUgLSDopoHmt7vliqDnmoTlgLxcclxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxib29sZWFuPn0g5pON5L2c57uT5p6cXHJcbiAgICovXHJcbiAgYXN5bmMgbHB1c2goa2V5LCB2YWx1ZSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgaWYgKHRoaXMucmVkaXMpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLnJlZGlzLmxwdXNoKGtleSwgSlNPTi5zdHJpbmdpZnkodmFsdWUpKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyDkvb/nlKjlhoXlrZjlrZjlgqjkvZzkuLrlkI7lpIdcclxuICAgICAgICBjb25zdCBsaXN0ID0gdGhpcy5tZW1vcnlTdG9yZS5nZXQoa2V5KT8udmFsdWUgfHwgW107XHJcbiAgICAgICAgbGlzdC51bnNoaWZ0KHZhbHVlKTtcclxuICAgICAgICB0aGlzLm1lbW9yeVN0b3JlLnNldChrZXksIHsgdmFsdWU6IGxpc3QsIHRpbWVzdGFtcDogRGF0ZS5ub3coKSB9KTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignUmVkaXPliJfooajmt7vliqDlpLHotKU6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5bliJfooajmiYDmnInlhYPntKBcclxuICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IC0g5YiX6KGo6ZSuXHJcbiAgICogQHJldHVybnMge1Byb21pc2U8QXJyYXk+fSDliJfooajlhYPntKBcclxuICAgKi9cclxuICBhc3luYyBscmFuZ2Uoa2V5LCBzdGFydCA9IDAsIGVuZCA9IC0xKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAodGhpcy5yZWRpcykge1xyXG4gICAgICAgIGNvbnN0IGl0ZW1zID0gYXdhaXQgdGhpcy5yZWRpcy5scmFuZ2Uoa2V5LCBzdGFydCwgZW5kKTtcclxuICAgICAgICByZXR1cm4gaXRlbXMubWFwKGl0ZW0gPT4gSlNPTi5wYXJzZShpdGVtKSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8g5L2/55So5YaF5a2Y5a2Y5YKo5L2c5Li65ZCO5aSHXHJcbiAgICAgICAgY29uc3QgbGlzdCA9IHRoaXMubWVtb3J5U3RvcmUuZ2V0KGtleSk/LnZhbHVlIHx8IFtdO1xyXG4gICAgICAgIGlmIChlbmQgPT09IC0xKSBlbmQgPSBsaXN0Lmxlbmd0aCAtIDE7XHJcbiAgICAgICAgcmV0dXJuIGxpc3Quc2xpY2Uoc3RhcnQsIGVuZCArIDEpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdSZWRpc+WIl+ihqOiOt+WPluWksei0pTonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOS7juWIl+ihqOS4reenu+mZpOWFg+e0oFxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSDliJfooajplK5cclxuICAgKiBAcGFyYW0ge2FueX0gdmFsdWUgLSDopoHnp7vpmaTnmoTlgLxcclxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxib29sZWFuPn0g5pON5L2c57uT5p6cXHJcbiAgICovXHJcbiAgYXN5bmMgbHJlbShrZXksIHZhbHVlKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAodGhpcy5yZWRpcykge1xyXG4gICAgICAgIGF3YWl0IHRoaXMucmVkaXMubHJlbShrZXksIDAsIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8g5L2/55So5YaF5a2Y5a2Y5YKo5L2c5Li65ZCO5aSHXHJcbiAgICAgICAgY29uc3QgbGlzdCA9IHRoaXMubWVtb3J5U3RvcmUuZ2V0KGtleSk/LnZhbHVlIHx8IFtdO1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gbGlzdC5maW5kSW5kZXgoaXRlbSA9PiBKU09OLnN0cmluZ2lmeShpdGVtKSA9PT0gSlNPTi5zdHJpbmdpZnkodmFsdWUpKTtcclxuICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XHJcbiAgICAgICAgICBsaXN0LnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICB0aGlzLm1lbW9yeVN0b3JlLnNldChrZXksIHsgdmFsdWU6IGxpc3QsIHRpbWVzdGFtcDogRGF0ZS5ub3coKSB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1JlZGlz5YiX6KGo56e76Zmk5aSx6LSlOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLy8g5Yib5bu65Y2V5L6L5a6e5L6LXHJcbmNvbnN0IHJlZGlzQ2xpZW50ID0gbmV3IFJlZGlzQ2xpZW50KCk7XHJcblxyXG5leHBvcnQgeyByZWRpc0NsaWVudCwgUmVkaXNDbGllbnQgfTsiXSwibmFtZXMiOlsiUmVkaXMiLCJSZWRpc0NsaWVudCIsImNvbnN0cnVjdG9yIiwicmVkaXNVcmwiLCJwcm9jZXNzIiwiZW52IiwiVVBTVEFTSF9SRURJU19SRVNUX1VSTCIsInJlZGlzVG9rZW4iLCJVUFNUQVNIX1JFRElTX1JFU1RfVE9LRU4iLCJjb25zb2xlIiwid2FybiIsInJlZGlzIiwibWVtb3J5U3RvcmUiLCJNYXAiLCJ1cmwiLCJ0b2tlbiIsImdldENsaWVudCIsImlzQ29ubmVjdGVkIiwic2V0Iiwia2V5IiwidmFsdWUiLCJ0dGwiLCJzZXJpYWxpemVkVmFsdWUiLCJKU09OIiwic3RyaW5naWZ5Iiwic2V0ZXgiLCJ0aW1lc3RhbXAiLCJEYXRlIiwibm93IiwiZXJyb3IiLCJnZXQiLCJwYXJzZSIsIml0ZW0iLCJkZWxldGUiLCJkZWwiLCJscHVzaCIsImxpc3QiLCJ1bnNoaWZ0IiwibHJhbmdlIiwic3RhcnQiLCJlbmQiLCJpdGVtcyIsIm1hcCIsImxlbmd0aCIsInNsaWNlIiwibHJlbSIsImluZGV4IiwiZmluZEluZGV4Iiwic3BsaWNlIiwicmVkaXNDbGllbnQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/redis_client.js\n");

/***/ }),

/***/ "(api)/./src/telegram_storage.js":
/*!*********************************!*\
  !*** ./src/telegram_storage.js ***!
  \*********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TelegramStorage: () => (/* binding */ TelegramStorage)\n/* harmony export */ });\n/* harmony import */ var node_telegram_bot_api__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node-telegram-bot-api */ \"node-telegram-bot-api\");\n/* harmony import */ var node_telegram_bot_api__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_telegram_bot_api__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! axios */ \"axios\");\n/* harmony import */ var _redis_client_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./redis_client.js */ \"(api)/./src/redis_client.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([axios__WEBPACK_IMPORTED_MODULE_1__, _redis_client_js__WEBPACK_IMPORTED_MODULE_2__]);\n([axios__WEBPACK_IMPORTED_MODULE_1__, _redis_client_js__WEBPACK_IMPORTED_MODULE_2__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\nclass TelegramStorage {\n    constructor(options){\n        this.botToken = options.botToken;\n        this.chatId = options.chatId;\n        // 允许注入客户端用于测试\n        this.telegramClient = options.telegramClient || new (node_telegram_bot_api__WEBPACK_IMPORTED_MODULE_0___default())(this.botToken, {\n            polling: false\n        });\n    }\n    /**\n   * 上传文件到Telegram\n   * @param {Buffer} fileBuffer - 文件内容的Buffer\n   * @param {string} fileName - 文件名\n   * @returns {Promise<{fileId: string, messageId: string}>} - 上传结果\n   */ async uploadFile(fileBuffer, fileName) {\n        try {\n            const response = await this.telegramClient.sendDocument(this.chatId, fileBuffer, {\n                filename: fileName\n            });\n            const fileInfo = {\n                fileId: response.document?.file_id || \"\",\n                messageId: response.message_id.toString(),\n                fileName: fileName,\n                fileSize: response.document?.file_size || fileBuffer.length,\n                uploadTime: new Date().toISOString(),\n                chatId: this.chatId\n            };\n            // 将文件信息存储到Redis中\n            const fileListKey = `files:${this.chatId}`;\n            await _redis_client_js__WEBPACK_IMPORTED_MODULE_2__.redisClient.lpush(fileListKey, fileInfo);\n            // 设置文件信息的单独键，方便快速查找\n            const fileKey = `file:${fileInfo.fileId}`;\n            await _redis_client_js__WEBPACK_IMPORTED_MODULE_2__.redisClient.set(fileKey, fileInfo, 86400 * 30); // 30天过期\n            return {\n                fileId: fileInfo.fileId,\n                messageId: fileInfo.messageId\n            };\n        } catch (error) {\n            console.error(\"上传文件到Telegram失败:\", error);\n            throw new Error(`上传文件失败: ${error.message}`);\n        }\n    }\n    /**\n   * 从Telegram下载文件\n   * @param {string} fileId - 文件ID\n   * @returns {Promise<string>} - 文件下载链接\n   */ async downloadFile(fileId) {\n        try {\n            const file = await this.telegramClient.getFile(fileId);\n            const fileLink = await this.telegramClient.getFileLink(file.file_id);\n            return fileLink;\n        } catch (error) {\n            console.error(\"从Telegram下载文件失败:\", error);\n            throw new Error(`下载文件失败: ${error.message}`);\n        }\n    }\n    /**\n   * 列出文件列表\n   * 优先从Redis获取，如果Redis为空则从Telegram同步\n   * @returns {Promise<Array<{fileId: string, fileName: string, messageId: string}>>} - 文件列表\n   */ async listFiles() {\n        try {\n            const fileListKey = `files:${this.chatId}`;\n            // 首先尝试从Redis获取文件列表\n            let files = await _redis_client_js__WEBPACK_IMPORTED_MODULE_2__.redisClient.lrange(fileListKey);\n            // 如果Redis中没有数据，从Telegram同步\n            if (!files || files.length === 0) {\n                console.log(\"Redis中无文件列表，从Telegram同步...\");\n                files = await this.syncFilesFromTelegram();\n            }\n            // 按上传时间倒序排列（最新的在前面）\n            files.sort((a, b)=>new Date(b.uploadTime) - new Date(a.uploadTime));\n            return files;\n        } catch (error) {\n            console.error(\"列出文件失败:\", error);\n            throw new Error(`列出文件失败: ${error.message}`);\n        }\n    }\n    /**\n   * 从Telegram同步文件列表到Redis\n   * @returns {Promise<Array>} 同步的文件列表\n   */ async syncFilesFromTelegram() {\n        try {\n            // 使用getUpdates获取最近的消息（包含文档的消息）\n            const updates = await this.telegramClient.getUpdates({\n                limit: 100,\n                allowed_updates: [\n                    \"message\"\n                ] // 只获取消息更新\n            });\n            const files = [];\n            const fileListKey = `files:${this.chatId}`;\n            // 遍历更新，查找包含文档的消息\n            for (const update of updates){\n                if (update.message && update.message.chat.id.toString() === this.chatId.toString() && update.message.document) {\n                    const doc = update.message.document;\n                    const fileInfo = {\n                        fileId: doc.file_id,\n                        fileName: doc.file_name || `document_${doc.file_id.slice(-8)}`,\n                        messageId: update.message.message_id.toString(),\n                        fileSize: doc.file_size,\n                        uploadTime: new Date(update.message.date * 1000).toISOString(),\n                        chatId: this.chatId\n                    };\n                    files.push(fileInfo);\n                    // 将文件信息存储到Redis\n                    await _redis_client_js__WEBPACK_IMPORTED_MODULE_2__.redisClient.lpush(fileListKey, fileInfo);\n                    // 设置文件信息的单独键\n                    const fileKey = `file:${fileInfo.fileId}`;\n                    await _redis_client_js__WEBPACK_IMPORTED_MODULE_2__.redisClient.set(fileKey, fileInfo, 86400 * 30); // 30天过期\n                }\n            }\n            console.log(`从Telegram同步了 ${files.length} 个文件到Redis`);\n            return files;\n        } catch (error) {\n            console.error(\"从Telegram同步文件失败:\", error);\n            return [];\n        }\n    }\n    /**\n   * 从Telegram删除文件\n   * @param {string} messageId - 消息ID\n   * @returns {Promise<boolean>} - 删除结果\n   */ async deleteFile(messageId) {\n        try {\n            // 从Telegram删除消息\n            await this.telegramClient.deleteMessage(this.chatId, messageId);\n            // 从Redis中删除文件信息\n            const fileListKey = `files:${this.chatId}`;\n            const files = await _redis_client_js__WEBPACK_IMPORTED_MODULE_2__.redisClient.lrange(fileListKey);\n            // 找到要删除的文件\n            const fileToDelete = files.find((file)=>file.messageId === messageId);\n            if (fileToDelete) {\n                // 从文件列表中移除\n                await _redis_client_js__WEBPACK_IMPORTED_MODULE_2__.redisClient.lrem(fileListKey, fileToDelete);\n                // 删除文件的单独键\n                const fileKey = `file:${fileToDelete.fileId}`;\n                await _redis_client_js__WEBPACK_IMPORTED_MODULE_2__.redisClient.del(fileKey);\n                console.log(`已从Redis删除文件: ${fileToDelete.fileName}`);\n            }\n            return true;\n        } catch (error) {\n            console.error(\"从Telegram删除文件失败:\", error);\n            throw new Error(`删除文件失败: ${error.message}`);\n        }\n    }\n}\n\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YUFBYS9DLE1BQU0sQ0FBQyxDQUFDO2dCQUM3QyxNQUFNZix5REFBV0EsQ0FBQ2lFLEdBQUcsQ0FBQ3BDO2dCQUV0QkcsUUFBUVcsR0FBRyxDQUFDLENBQUMsYUFBYSxFQUFFbUIsYUFBYXBELFFBQVEsQ0FBQyxDQUFDO1lBQ3JEO1lBRUEsT0FBTztRQUNULEVBQUUsT0FBT3FCLE9BQU87WUFDZEMsUUFBUUQsS0FBSyxDQUFDLG9CQUFvQkE7WUFDbEMsTUFBTSxJQUFJRSxNQUFNLENBQUMsUUFBUSxFQUFFRixNQUFNRyxPQUFPLENBQUMsQ0FBQztRQUM1QztJQUNGO0FBQ0Y7QUFFMkIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90Zy1uZXQtYnVja2V0Ly4vc3JjL3RlbGVncmFtX3N0b3JhZ2UuanM/ZmEzZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVGVsZWdyYW1Cb3QgZnJvbSAnbm9kZS10ZWxlZ3JhbS1ib3QtYXBpJztcbmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7XG5pbXBvcnQgeyByZWRpc0NsaWVudCB9IGZyb20gJy4vcmVkaXNfY2xpZW50LmpzJztcblxuY2xhc3MgVGVsZWdyYW1TdG9yYWdlIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIHRoaXMuYm90VG9rZW4gPSBvcHRpb25zLmJvdFRva2VuO1xuICAgIHRoaXMuY2hhdElkID0gb3B0aW9ucy5jaGF0SWQ7XG4gICAgXG4gICAgLy8g5YWB6K645rOo5YWl5a6i5oi356uv55So5LqO5rWL6K+VXG4gICAgdGhpcy50ZWxlZ3JhbUNsaWVudCA9IG9wdGlvbnMudGVsZWdyYW1DbGllbnQgfHwgbmV3IFRlbGVncmFtQm90KHRoaXMuYm90VG9rZW4sIHsgcG9sbGluZzogZmFsc2UgfSk7XG4gIH1cblxuICAvKipcbiAgICog5LiK5Lyg5paH5Lu25YiwVGVsZWdyYW1cbiAgICogQHBhcmFtIHtCdWZmZXJ9IGZpbGVCdWZmZXIgLSDmlofku7blhoXlrrnnmoRCdWZmZXJcbiAgICogQHBhcmFtIHtzdHJpbmd9IGZpbGVOYW1lIC0g5paH5Lu25ZCNXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPHtmaWxlSWQ6IHN0cmluZywgbWVzc2FnZUlkOiBzdHJpbmd9Pn0gLSDkuIrkvKDnu5PmnpxcbiAgICovXG4gIGFzeW5jIHVwbG9hZEZpbGUoZmlsZUJ1ZmZlciwgZmlsZU5hbWUpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnRlbGVncmFtQ2xpZW50LnNlbmREb2N1bWVudCh0aGlzLmNoYXRJZCwgZmlsZUJ1ZmZlciwge1xuICAgICAgICBmaWxlbmFtZTogZmlsZU5hbWVcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCBmaWxlSW5mbyA9IHtcbiAgICAgICAgZmlsZUlkOiByZXNwb25zZS5kb2N1bWVudD8uZmlsZV9pZCB8fCAnJyxcbiAgICAgICAgbWVzc2FnZUlkOiByZXNwb25zZS5tZXNzYWdlX2lkLnRvU3RyaW5nKCksXG4gICAgICAgIGZpbGVOYW1lOiBmaWxlTmFtZSxcbiAgICAgICAgZmlsZVNpemU6IHJlc3BvbnNlLmRvY3VtZW50Py5maWxlX3NpemUgfHwgZmlsZUJ1ZmZlci5sZW5ndGgsXG4gICAgICAgIHVwbG9hZFRpbWU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgY2hhdElkOiB0aGlzLmNoYXRJZFxuICAgICAgfTtcbiAgICAgIFxuICAgICAgLy8g5bCG5paH5Lu25L+h5oGv5a2Y5YKo5YiwUmVkaXPkuK1cbiAgICAgIGNvbnN0IGZpbGVMaXN0S2V5ID0gYGZpbGVzOiR7dGhpcy5jaGF0SWR9YDtcbiAgICAgIGF3YWl0IHJlZGlzQ2xpZW50LmxwdXNoKGZpbGVMaXN0S2V5LCBmaWxlSW5mbyk7XG4gICAgICBcbiAgICAgIC8vIOiuvue9ruaWh+S7tuS/oeaBr+eahOWNleeLrOmUru+8jOaWueS+v+W/q+mAn+afpeaJvlxuICAgICAgY29uc3QgZmlsZUtleSA9IGBmaWxlOiR7ZmlsZUluZm8uZmlsZUlkfWA7XG4gICAgICBhd2FpdCByZWRpc0NsaWVudC5zZXQoZmlsZUtleSwgZmlsZUluZm8sIDg2NDAwICogMzApOyAvLyAzMOWkqei/h+acn1xuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICBmaWxlSWQ6IGZpbGVJbmZvLmZpbGVJZCxcbiAgICAgICAgbWVzc2FnZUlkOiBmaWxlSW5mby5tZXNzYWdlSWRcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+S4iuS8oOaWh+S7tuWIsFRlbGVncmFt5aSx6LSlOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihg5LiK5Lyg5paH5Lu25aSx6LSlOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOS7jlRlbGVncmFt5LiL6L295paH5Lu2XG4gICAqIEBwYXJhbSB7c3RyaW5nfSBmaWxlSWQgLSDmlofku7ZJRFxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxzdHJpbmc+fSAtIOaWh+S7tuS4i+i9vemTvuaOpVxuICAgKi9cbiAgYXN5bmMgZG93bmxvYWRGaWxlKGZpbGVJZCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBmaWxlID0gYXdhaXQgdGhpcy50ZWxlZ3JhbUNsaWVudC5nZXRGaWxlKGZpbGVJZCk7XG4gICAgICBjb25zdCBmaWxlTGluayA9IGF3YWl0IHRoaXMudGVsZWdyYW1DbGllbnQuZ2V0RmlsZUxpbmsoZmlsZS5maWxlX2lkKTtcbiAgICAgIHJldHVybiBmaWxlTGluaztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign5LuOVGVsZWdyYW3kuIvovb3mlofku7blpLHotKU6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGDkuIvovb3mlofku7blpLHotKU6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5YiX5Ye65paH5Lu25YiX6KGoXG4gICAqIOS8mOWFiOS7jlJlZGlz6I635Y+W77yM5aaC5p6cUmVkaXPkuLrnqbrliJnku45UZWxlZ3JhbeWQjOatpVxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxBcnJheTx7ZmlsZUlkOiBzdHJpbmcsIGZpbGVOYW1lOiBzdHJpbmcsIG1lc3NhZ2VJZDogc3RyaW5nfT4+fSAtIOaWh+S7tuWIl+ihqFxuICAgKi9cbiAgYXN5bmMgbGlzdEZpbGVzKCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBmaWxlTGlzdEtleSA9IGBmaWxlczoke3RoaXMuY2hhdElkfWA7XG4gICAgICBcbiAgICAgIC8vIOmmluWFiOWwneivleS7jlJlZGlz6I635Y+W5paH5Lu25YiX6KGoXG4gICAgICBsZXQgZmlsZXMgPSBhd2FpdCByZWRpc0NsaWVudC5scmFuZ2UoZmlsZUxpc3RLZXkpO1xuICAgICAgXG4gICAgICAvLyDlpoLmnpxSZWRpc+S4reayoeacieaVsOaNru+8jOS7jlRlbGVncmFt5ZCM5q2lXG4gICAgICBpZiAoIWZpbGVzIHx8IGZpbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBjb25zb2xlLmxvZygnUmVkaXPkuK3ml6Dmlofku7bliJfooajvvIzku45UZWxlZ3JhbeWQjOatpS4uLicpO1xuICAgICAgICBmaWxlcyA9IGF3YWl0IHRoaXMuc3luY0ZpbGVzRnJvbVRlbGVncmFtKCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOaMieS4iuS8oOaXtumXtOWAkuW6j+aOkuWIl++8iOacgOaWsOeahOWcqOWJjemdou+8iVxuICAgICAgZmlsZXMuc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYi51cGxvYWRUaW1lKSAtIG5ldyBEYXRlKGEudXBsb2FkVGltZSkpO1xuICAgICAgXG4gICAgICByZXR1cm4gZmlsZXM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIl+WHuuaWh+S7tuWksei0pTonLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYOWIl+WHuuaWh+S7tuWksei0pTogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDku45UZWxlZ3JhbeWQjOatpeaWh+S7tuWIl+ihqOWIsFJlZGlzXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPEFycmF5Pn0g5ZCM5q2l55qE5paH5Lu25YiX6KGoXG4gICAqL1xuICBhc3luYyBzeW5jRmlsZXNGcm9tVGVsZWdyYW0oKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIOS9v+eUqGdldFVwZGF0ZXPojrflj5bmnIDov5HnmoTmtojmga/vvIjljIXlkKvmlofmoaPnmoTmtojmga/vvIlcbiAgICAgIGNvbnN0IHVwZGF0ZXMgPSBhd2FpdCB0aGlzLnRlbGVncmFtQ2xpZW50LmdldFVwZGF0ZXMoe1xuICAgICAgICBsaW1pdDogMTAwLCAvLyDojrflj5bmnIDov5ExMDDmnaHmm7TmlrBcbiAgICAgICAgYWxsb3dlZF91cGRhdGVzOiBbJ21lc3NhZ2UnXSAvLyDlj6rojrflj5bmtojmga/mm7TmlrBcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCBmaWxlcyA9IFtdO1xuICAgICAgY29uc3QgZmlsZUxpc3RLZXkgPSBgZmlsZXM6JHt0aGlzLmNoYXRJZH1gO1xuICAgICAgXG4gICAgICAvLyDpgY3ljobmm7TmlrDvvIzmn6Xmib7ljIXlkKvmlofmoaPnmoTmtojmga9cbiAgICAgIGZvciAoY29uc3QgdXBkYXRlIG9mIHVwZGF0ZXMpIHtcbiAgICAgICAgaWYgKHVwZGF0ZS5tZXNzYWdlICYmIFxuICAgICAgICAgICAgdXBkYXRlLm1lc3NhZ2UuY2hhdC5pZC50b1N0cmluZygpID09PSB0aGlzLmNoYXRJZC50b1N0cmluZygpICYmXG4gICAgICAgICAgICB1cGRhdGUubWVzc2FnZS5kb2N1bWVudCkge1xuICAgICAgICAgIFxuICAgICAgICAgIGNvbnN0IGRvYyA9IHVwZGF0ZS5tZXNzYWdlLmRvY3VtZW50O1xuICAgICAgICAgIGNvbnN0IGZpbGVJbmZvID0ge1xuICAgICAgICAgICAgZmlsZUlkOiBkb2MuZmlsZV9pZCxcbiAgICAgICAgICAgIGZpbGVOYW1lOiBkb2MuZmlsZV9uYW1lIHx8IGBkb2N1bWVudF8ke2RvYy5maWxlX2lkLnNsaWNlKC04KX1gLFxuICAgICAgICAgICAgbWVzc2FnZUlkOiB1cGRhdGUubWVzc2FnZS5tZXNzYWdlX2lkLnRvU3RyaW5nKCksXG4gICAgICAgICAgICBmaWxlU2l6ZTogZG9jLmZpbGVfc2l6ZSxcbiAgICAgICAgICAgIHVwbG9hZFRpbWU6IG5ldyBEYXRlKHVwZGF0ZS5tZXNzYWdlLmRhdGUgKiAxMDAwKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgY2hhdElkOiB0aGlzLmNoYXRJZFxuICAgICAgICAgIH07XG4gICAgICAgICAgXG4gICAgICAgICAgZmlsZXMucHVzaChmaWxlSW5mbyk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8g5bCG5paH5Lu25L+h5oGv5a2Y5YKo5YiwUmVkaXNcbiAgICAgICAgICBhd2FpdCByZWRpc0NsaWVudC5scHVzaChmaWxlTGlzdEtleSwgZmlsZUluZm8pO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIOiuvue9ruaWh+S7tuS/oeaBr+eahOWNleeLrOmUrlxuICAgICAgICAgIGNvbnN0IGZpbGVLZXkgPSBgZmlsZToke2ZpbGVJbmZvLmZpbGVJZH1gO1xuICAgICAgICAgIGF3YWl0IHJlZGlzQ2xpZW50LnNldChmaWxlS2V5LCBmaWxlSW5mbywgODY0MDAgKiAzMCk7IC8vIDMw5aSp6L+H5pyfXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coYOS7jlRlbGVncmFt5ZCM5q2l5LqGICR7ZmlsZXMubGVuZ3RofSDkuKrmlofku7bliLBSZWRpc2ApO1xuICAgICAgcmV0dXJuIGZpbGVzO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfku45UZWxlZ3JhbeWQjOatpeaWh+S7tuWksei0pTonLCBlcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOS7jlRlbGVncmFt5Yig6Zmk5paH5Lu2XG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlSWQgLSDmtojmga9JRFxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxib29sZWFuPn0gLSDliKDpmaTnu5PmnpxcbiAgICovXG4gIGFzeW5jIGRlbGV0ZUZpbGUobWVzc2FnZUlkKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIOS7jlRlbGVncmFt5Yig6Zmk5raI5oGvXG4gICAgICBhd2FpdCB0aGlzLnRlbGVncmFtQ2xpZW50LmRlbGV0ZU1lc3NhZ2UodGhpcy5jaGF0SWQsIG1lc3NhZ2VJZCk7XG4gICAgICBcbiAgICAgIC8vIOS7jlJlZGlz5Lit5Yig6Zmk5paH5Lu25L+h5oGvXG4gICAgICBjb25zdCBmaWxlTGlzdEtleSA9IGBmaWxlczoke3RoaXMuY2hhdElkfWA7XG4gICAgICBjb25zdCBmaWxlcyA9IGF3YWl0IHJlZGlzQ2xpZW50LmxyYW5nZShmaWxlTGlzdEtleSk7XG4gICAgICBcbiAgICAgIC8vIOaJvuWIsOimgeWIoOmZpOeahOaWh+S7tlxuICAgICAgY29uc3QgZmlsZVRvRGVsZXRlID0gZmlsZXMuZmluZChmaWxlID0+IGZpbGUubWVzc2FnZUlkID09PSBtZXNzYWdlSWQpO1xuICAgICAgaWYgKGZpbGVUb0RlbGV0ZSkge1xuICAgICAgICAvLyDku47mlofku7bliJfooajkuK3np7vpmaRcbiAgICAgICAgYXdhaXQgcmVkaXNDbGllbnQubHJlbShmaWxlTGlzdEtleSwgZmlsZVRvRGVsZXRlKTtcbiAgICAgICAgXG4gICAgICAgIC8vIOWIoOmZpOaWh+S7tueahOWNleeLrOmUrlxuICAgICAgICBjb25zdCBmaWxlS2V5ID0gYGZpbGU6JHtmaWxlVG9EZWxldGUuZmlsZUlkfWA7XG4gICAgICAgIGF3YWl0IHJlZGlzQ2xpZW50LmRlbChmaWxlS2V5KTtcbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKGDlt7Lku45SZWRpc+WIoOmZpOaWh+S7tjogJHtmaWxlVG9EZWxldGUuZmlsZU5hbWV9YCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfku45UZWxlZ3JhbeWIoOmZpOaWh+S7tuWksei0pTonLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYOWIoOmZpOaWh+S7tuWksei0pTogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgeyBUZWxlZ3JhbVN0b3JhZ2UgfTsiXSwibmFtZXMiOlsiVGVsZWdyYW1Cb3QiLCJheGlvcyIsInJlZGlzQ2xpZW50IiwiVGVsZWdyYW1TdG9yYWdlIiwiY29uc3RydWN0b3IiLCJvcHRpb25zIiwiYm90VG9rZW4iLCJjaGF0SWQiLCJ0ZWxlZ3JhbUNsaWVudCIsInBvbGxpbmciLCJ1cGxvYWRGaWxlIiwiZmlsZUJ1ZmZlciIsImZpbGVOYW1lIiwicmVzcG9uc2UiLCJzZW5kRG9jdW1lbnQiLCJmaWxlbmFtZSIsImZpbGVJbmZvIiwiZmlsZUlkIiwiZG9jdW1lbnQiLCJmaWxlX2lkIiwibWVzc2FnZUlkIiwibWVzc2FnZV9pZCIsInRvU3RyaW5nIiwiZmlsZVNpemUiLCJmaWxlX3NpemUiLCJsZW5ndGgiLCJ1cGxvYWRUaW1lIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiZmlsZUxpc3RLZXkiLCJscHVzaCIsImZpbGVLZXkiLCJzZXQiLCJlcnJvciIsImNvbnNvbGUiLCJFcnJvciIsIm1lc3NhZ2UiLCJkb3dubG9hZEZpbGUiLCJmaWxlIiwiZ2V0RmlsZSIsImZpbGVMaW5rIiwiZ2V0RmlsZUxpbmsiLCJsaXN0RmlsZXMiLCJmaWxlcyIsImxyYW5nZSIsImxvZyIsInN5bmNGaWxlc0Zyb21UZWxlZ3JhbSIsInNvcnQiLCJhIiwiYiIsInVwZGF0ZXMiLCJnZXRVcGRhdGVzIiwibGltaXQiLCJhbGxvd2VkX3VwZGF0ZXMiLCJ1cGRhdGUiLCJjaGF0IiwiaWQiLCJkb2MiLCJmaWxlX25hbWUiLCJzbGljZSIsImRhdGUiLCJwdXNoIiwiZGVsZXRlRmlsZSIsImRlbGV0ZU1lc3NhZ2UiLCJmaWxlVG9EZWxldGUiLCJmaW5kIiwibHJlbSIsImRlbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/telegram_storage.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffiles&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cfiles.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();